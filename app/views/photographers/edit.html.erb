<% key = Rails.application.config.session_options[:key] %>

<%= content_for :head_script do %>
<script type="text/javascript">
		$(document).ready(function() {
			// Handler for .ready() called.
				$("#sortable" ).sortable({ 
					revert: true,
					stop: function(e,ui) {
						$.ajax({
							data: $('#sortable').sortable('serialize'),
							type: 'POST',
							url: '<%= sort_photographer_path(@photographer) %>',
							success: function () {
							// it worked!  
							},
							error: function (response) {
							// we had an error
							}
						});
						
					}
					
					});
				$("#sortable").disableSelection();
		});
</script>
<% end %>

<%= semantic_form_for @photographer, :url => photographer_path, :html => {:method => :put} do |f| %>
	<%= f.inputs :name => "Your information" do %>
		<%= f.input :name, :input_html => { :size => 40 } %>
		<%= f.input :description, :input_html => { :class => 'autogrow', :rows => 10, :cols => 40 } %>
		<%= f.input :facebook_url, :input_html => { :size => 40 } %>
	<% end %>

	<%= f.actions do %>
		<%= f.action :submit, :as => :button %>
		<%= f.action :cancel, :as => :link %>
	<% end %>

	<%= f.inputs :name => "Your stories <a href='#{new_story_path}'>(Add a story)</a>" do %>
		<div id="photos">
			<ul id="sortable">
				<%= render :partial => 'photographers/story', :collection => @photographer.stories %>
			</ul>
			<div style="clear: both;"></div>
		</div>

	<% end %>

<% end %>
